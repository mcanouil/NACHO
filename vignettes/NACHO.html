<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="G.A. Bouland, M. Canouil, PhD, R.C. Slieker, PhD" />

<meta name="date" content="2019-03-22" />

<title>NACHO</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">NACHO</h1>
<h3 class="subtitle"><em>A NanoString Quality-Control Dashboard</em></h3>
<h4 class="author"><em>G.A. Bouland, M. Canouil, PhD, R.C. Slieker, PhD</em></h4>
<h4 class="date"><em>March 22, 2019</em></h4>


<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#example"><span class="toc-section-number">2</span> Example</a></li>
<li><a href="#the-summarise-function"><span class="toc-section-number">3</span> The <code>summarise()</code> function</a><ul>
<li><a href="#presummarised-nanostring-ncounter-data"><span class="toc-section-number">3.1</span> Presummarised NanoString nCounter data</a></li>
<li><a href="#nanostring-ncounter-data-from-geo"><span class="toc-section-number">3.2</span> NanoString nCounter data from GEO</a></li>
</ul></li>
<li><a href="#the-visualise-function"><span class="toc-section-number">4</span> The <code>visualise()</code> function</a></li>
<li><a href="#the-normalise-function"><span class="toc-section-number">5</span> The <code>normalise()</code> function</a></li>
<li><a href="#references"><span class="toc-section-number">6</span> References</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p><em>NACHO</em> (NanoString Quality Control Dashboard) is developed for NanoString nCounter data. NanoString nCounter data is a mRNA or miRNA expression assay and works with fluorescent barcodes. Each barcode is assigned a mRNA/miRNA, which can be counted after bonding with its target. As a result each count of a specific barcode represents the presence of its target mRNA/miRNA.</p>
<p><em>NACHO</em> is able to load, visualize and normalize the exported NanoString nCounter data and facilitates the user in performing a quality control. <em>NACHO</em> does this by visualizing Quality Control metrics, expression of control genes, principal components and sample specific size factors in an interactive web application. With the use of two functions, RCC files are summarised and visualised, namely; <code>summarise()</code> and <code>summarise()</code>. The <code>summarise()</code> function is used to preprocess the data. The <code>visualise()</code> function initiates a RStudio Shiny-based dashboard that visualizes all relevant QC plots.</p>
<p><em>NACHO</em> also includes a function <code>normalise()</code>, which calculates sample specific size factors and normalizes the data. <code>normalise()</code> creates a list in which your settings, the raw counts and normalised counts are stored.</p>
</div>
<div id="example" class="section level1">
<h1><span class="header-section-number">2</span> Example</h1>
<p>To display the usage and utility of <em>NACHO</em>, we show three examples in which the above mentioned functions are used and the results are briefly examined. <em>NACHO</em> comes with presummarised data and in the first example we use this data to call the interactive web application with the use of <code>visualise()</code>. In the second example we show the process of going from raw RCC files to visualisations with a data set queried from <strong>GEO</strong> using <code>GEOquery</code>.<br />
In the third example we use the summarised data from second example to calculate the sample specific size factors using <code>normalise()</code> and its added functionality to predict housekeeping genes.</p>
<p>Besides creating interactive visualisations, <em>NACHO</em> also identifies poorly performing samples which can be seen under the Outlier Table tab in the interactive web application.<br />
While calling <code>normalise()</code> the user has the possibility to remove these outliers before size factor calculation.</p>
</div>
<div id="the-summarise-function" class="section level1">
<h1><span class="header-section-number">3</span> The <code>summarise()</code> function</h1>
<div id="presummarised-nanostring-ncounter-data" class="section level2">
<h2><span class="header-section-number">3.1</span> Presummarised NanoString nCounter data</h2>
<p>This example shows how to use summarised data to call the interactive web application.<br />
The raw data used in the summarisation is from a study of Liu MC et al. [1] and was acquired from the NCBI GEO public database [2].</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(NACHO)
<span class="kw">data</span>(GSE74821)
<span class="kw">visualise</span>(GSE74821)</code></pre></div>
</div>
<div id="nanostring-ncounter-data-from-geo" class="section level2">
<h2><span class="header-section-number">3.2</span> NanoString nCounter data from GEO</h2>
<p>Numerous NanoString nCounter data sets are available from GEO.<br />
In this example we use a mRNA dataset from the study of <em>Bruce</em> et al. [2] with the GEO accession number: <strong>GSE70970</strong>. The data is extracted and prepared using the following code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(GEOquery)
<span class="co">#Download data</span>
gse &lt;-<span class="st"> </span><span class="kw">getGEO</span>(<span class="st">&quot;GSE70970&quot;</span>)
<span class="co">#Get phenotypes</span>
targets &lt;-<span class="st"> </span><span class="kw">pData</span>(<span class="kw">phenoData</span>(gse[[<span class="dv">1</span>]]))
<span class="kw">getGEOSuppFiles</span>(<span class="st">&quot;GSE70970&quot;</span>)
<span class="co">#Unzip data</span>
<span class="kw">untar</span>(<span class="st">&quot;GSE70970/GSE70970_RAW.tar&quot;</span>, <span class="dt">exdir =</span> <span class="st">&quot;GSE70970/Data&quot;</span>)
<span class="co">#Add IDs</span>
IDs &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="st">&quot;GSE70970/Data&quot;</span>)
targets<span class="op">$</span>IDFILE &lt;-<span class="st"> </span>IDs</code></pre></div>
<p>After we extracted the dataset to the <code>./Data</code> directory, the <code>Samplesheet.csv</code> is written containing a column with the exact names of the files for each sample. Subsequently <code>summarise()</code> is called.<br />
The first argument requires the path to the directory containing the RCC files, the second argument is the location of samplesheet followed by third argument with the column name containing the exact names of the files.<br />
The following two arguments consecutively indicate which housekeeping genes and normalisation method ought to be used.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(NACHO)
GSE70970_sum &lt;-<span class="st"> </span><span class="kw">summarize</span>(<span class="dt">data_directory =</span>  <span class="st">&quot;GSE70970/Data/&quot;</span>, <span class="co"># Where the data is</span>
                 <span class="dt">ssheet_csv =</span> targets, <span class="co"># The samplesheet</span>
                 <span class="dt">normalisation_method=</span><span class="st">&quot;GEO&quot;</span>, <span class="co"># Geometric mean or GLM</span>
                 <span class="dt">housekeeping_genes =</span> <span class="ot">NULL</span>, <span class="co"># Custom list of housekeeping genes</span>
                 <span class="dt">id_colname =</span> <span class="st">&quot;IDFILE&quot;</span>, <span class="co"># Name of the column that contains the identfiers</span>
                 <span class="dt">housekeeping_predict =</span> <span class="ot">TRUE</span>, <span class="co"># Predict the housekeeping genes based on the data?</span>
                 <span class="dt">n_comp=</span><span class="dv">5</span>) <span class="co"># Number indicating the number of principal components to compute. </span></code></pre></div>
<pre><code>## [NACHO] Importing RCC files.</code></pre>
<pre><code>## [NACHO] Performing QC and formatting data.</code></pre>
<pre><code>## [NACHO] Searching for the best housekeeping genes.</code></pre>
<pre><code>## [NACHO] Computing normalisation factors using &quot;GEO&quot; method for housekeeping genes prediction.</code></pre>
<pre><code>## [NACHO] Could not find suitable houskeeping genes, default will be used.</code></pre>
<pre><code>## [NACHO] Computing normalisation factors using &quot;GEO&quot; method.</code></pre>
<pre><code>## [NACHO] Missing values have been replaced with zeros for PCA.</code></pre>
<pre><code>## [NACHO] Normalising data using &quot;GEO&quot; method with housekeeping genes.</code></pre>
<pre><code>## [NACHO] Returning a list.
##   $ access              : character
##   $ housekeeping_genes  : character
##   $ housekeeping_predict: logical
##   $ housekeeping_norm   : logical
##   $ normalisation_method: character
##   $ remove_outliers     : logical
##   $ n_comp              : numeric
##   $ data_directory      : character
##   $ pc_sum              : data.frame
##   $ nacho               : data.frame
##   $ raw_counts          : data.frame
##   $ normalised_counts   : data.frame</code></pre>
</div>
</div>
<div id="the-visualise-function" class="section level1">
<h1><span class="header-section-number">4</span> The <code>visualise()</code> function</h1>
<p>When the summarisation is done, the summarised (or normalised) data can be visualised using the <code>visualise()</code> function as can be seen in the following chunk of code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">visualise</span>(GSE70970_sum)</code></pre></div>
<p>On the left there are widgets that control the interactive plotting area. These widgets differ dependent on which main tab is chosen. The second layer of tabs is also interactive and changes based on which main tab is chosen. Each sample in the plots can be coloured based on either technical specifications which are included in the RCC files or based on specifications of your own choosing, though these specifications need to be included in the samplesheet.</p>
</div>
<div id="the-normalise-function" class="section level1">
<h1><span class="header-section-number">5</span> The <code>normalise()</code> function</h1>
<p><em>NACHO</em> is allows the discovery of housekeeping genes within your own dataset. <em>NACHO</em> finds the five best suitable housekeeping genes, however, it is possible that one of these five genes might not be suitable, which is why a subset of these discovered housekeeping genes might work better in some cases. For this example we use the <strong>GSE70970</strong> dataset from the previous example. The discovered housekeeping genes are saved in a global variable named <strong>predicted_housekeeping</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(GSE70970_sum[[<span class="st">&quot;housekeeping_genes&quot;</span>]])</code></pre></div>
<pre><code>## [1] &quot;RPLP0&quot; &quot;RPL19&quot; &quot;ACTB&quot;  &quot;GAPDH&quot; &quot;B2M&quot;</code></pre>
<p>Let’s say <em>RPLP0</em> and <em>RPL19</em> are not suitable, therefore, you want to exclude these genes from the normalisation process.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_housekeeping &lt;-<span class="st"> </span>GSE70970_sum[[<span class="st">&quot;housekeeping_genes&quot;</span>]][<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)]
<span class="kw">print</span>(my_housekeeping)</code></pre></div>
<pre><code>## [1] &quot;ACTB&quot;  &quot;GAPDH&quot; &quot;B2M&quot;</code></pre>
<p>The next step is the actual normalisation. The first argument requires the summary which is created with the <code>summarise()</code> function. The second arugument requires a vector of gene names. In this case it is a subset of the discovered housekeeping genes we just made. With the third argument the user has the choice to remove the outliers. Lastly the normalisation method can be choosed.<br />
Here the user has a choice between <code>&quot;GLM&quot;</code> or <code>&quot;GEO&quot;</code>. The differences between normalisation methods are nuanced, however, a preference for either method are use case specific.<br />
In this example <code>&quot;GLM&quot;</code> is used.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">GSE70970_norm &lt;-<span class="st"> </span><span class="kw">normalise</span>(
  <span class="dt">nacho_object =</span> GSE70970_sum,
  <span class="dt">housekeeping_genes =</span> my_housekeeping,
  <span class="dt">housekeeping_norm =</span> <span class="ot">TRUE</span>,
  <span class="dt">normalisation_method =</span> <span class="st">&quot;GEO&quot;</span>, 
  <span class="dt">remove_outliers =</span> <span class="ot">TRUE</span>
)</code></pre></div>
<pre><code>## [NACHO] Note: &quot;housekeeping_genes&quot; is different from the parameter used in &quot;summarise()&quot;.
## - &quot;summarise()&quot;:
##     housekeeping_genes=c(&quot;RPLP0&quot;, &quot;RPL19&quot;, &quot;ACTB&quot;, &quot;GAPDH&quot;, &quot;B2M&quot;)
## - &quot;normalise()&quot;:
##     housekeeping_genes=c(&quot;ACTB&quot;, &quot;GAPDH&quot;, &quot;B2M&quot;)</code></pre>
<pre><code>## [NACHO] Computing normalisation factors using &quot;GEO&quot; method.</code></pre>
<pre><code>## [NACHO] Missing values have been replaced with zeros for PCA.</code></pre>
<pre><code>## [NACHO] Returning a list.
##   $ access              : character
##   $ housekeeping_genes  : character
##   $ housekeeping_predict: logical
##   $ housekeeping_norm   : logical
##   $ normalisation_method: character
##   $ remove_outliers     : logical
##   $ n_comp              : numeric
##   $ data_directory      : character
##   $ pc_sum              : data.frame
##   $ nacho               : data.frame
##   $ raw_counts          : data.frame
##   $ normalised_counts   : data.frame</code></pre>
<p><code>normalise()</code> returns a <code>list</code> object (same as <code>summarise()</code>) with <code>raw_counts</code> and <code>normalised_counts</code> slots filled with the raw and normalised counts. Both counts are also in the <em>NACHO</em> data.frame.</p>
</div>
<div id="references" class="section level1">
<h1><span class="header-section-number">6</span> References</h1>
<p>[1] Liu MC, Pitcher BN, Mardis ER, Davies SR, Friedman PN, Snider JE, Vickery TL, Reed JP, DeSchryver K, Singh B, Gradishar WJ, Perez EA, Martino S, Citron ML, Norton L, Winer EP, Hudis CA, Carey LA, Bernard PS, Nielsen TO, Perou CM, Ellis MJ, Barry WT. PAM50 gene signatures and breast cancer prognosis with adjuvant anthracycline- and taxane-based chemotherapy: correlative analysis of C9741 (Alliance). Npj Breast Cancer 2:15023 (2016) <a href="http://dx.doi.org/10.1038/npjbcancer.2015.23" class="uri">http://dx.doi.org/10.1038/npjbcancer.2015.23</a></p>
<p>[2] Barrett T, Wilhite SE, Ledoux P, Evangelista C, Kim IF, Tomashevsky M, Marshall KA, Phillippy KH, Sherman PM, Holko M, Yefanov A, Lee H, Zhang N, Robertson CL, Serova N, Davis S, Soboleva A. NCBI GEO: archive for functional genomics data sets–update. Nucleic Acids Res. 2013 Jan;41(Database issue):D991-5.</p>
<p>[3] Bruce JP, Hui AB, Shi W, Perez-Ordonez B et al. Identification of a microRNA signature associated with risk of distant metastasis in nasopharyngeal carcinoma. Oncotarget 2015 Feb 28;6(6):4537-50. PMID: 25738365</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
