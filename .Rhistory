df[x,y] <- wilcox.test(as.numeric(dcasted[,x]),as.numeric(dcasted[,y]), exact = F)$p.value
}
}
res <- (colSums(df)-1)/7
print(res)
print(names(res[res<0.05]))
}
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
median.test
median.test <- function(x, y){
z <- c(x, y)
g <- rep(1:2, c(length(x), length(y)))
m <- median(z)
fisher.test(z < m, g)$p.value
}
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
mat_dim <- length(colnames(dcasted))
df <- data.frame(matrix(NA, nrow = mat_dim, ncol = mat_dim))
colnames(df) <- colnames(dcasted)
rownames(df) <- colnames(dcasted)
for(x in 1:mat_dim){
for(y in 1:mat_dim){
df[x,y] <- median.test(as.numeric(dcasted[,x]),as.numeric(dcasted[,y]))
}
}
res <- (colSums(df)-1)/7
print(res)
print(names(res[res<0.05]))
}
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
mat_dim <- length(colnames(dcasted))
df <- data.frame(matrix(NA, nrow = mat_dim, ncol = mat_dim))
colnames(df) <- colnames(dcasted)
rownames(df) <- colnames(dcasted)
for(x in 1:mat_dim){
for(y in 1:mat_dim){
df[x,y] <- median.test(as.numeric(dcasted[,x]),as.numeric(dcasted[,y]))
}
}
print(df)
res <- (colSums(df)-1)/7
print(res)
print(names(res[res<0.05]))
}
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
res <- (colSums(df <= 0.05))/7
res
df
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
mat_dim <- length(colnames(dcasted))
df <- data.frame(matrix(NA, nrow = mat_dim, ncol = mat_dim))
colnames(df) <- colnames(dcasted)
rownames(df) <- colnames(dcasted)
for(x in 1:mat_dim){
for(y in 1:mat_dim){
df[x,y] <- median.test(as.numeric(dcasted[,x]),as.numeric(dcasted[,y]))
}
}
res <- (colSums(df <= 0.05))/7
print(res)
print(names(res[res<0.05]))
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
res <- ifelse(colSums(df <= 0.05) >= 4,TRUE, FALSE)
print(res)
df <= 0.05
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
mat_dim <- length(colnames(dcasted))
df <- data.frame(matrix(NA, nrow = mat_dim, ncol = mat_dim))
colnames(df) <- colnames(dcasted)
rownames(df) <- colnames(dcasted)
for(x in 1:mat_dim){
for(y in 1:mat_dim){
df[x,y] <- median.test(as.numeric(dcasted[,x]),as.numeric(dcasted[,y]))
}
}
res <- ifelse(colSums(df <= 0.05) >= 4,TRUE, FALSE)
print(res)
print(names(res[res<0.05]))
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
mat_dim <- length(colnames(dcasted))
df <- data.frame(matrix(NA, nrow = mat_dim, ncol = mat_dim))
colnames(df) <- colnames(dcasted)
rownames(df) <- colnames(dcasted)
for(x in 1:mat_dim){
for(y in 1:mat_dim){
df[x,y] <- median.test(as.numeric(dcasted[,x]),as.numeric(dcasted[,y]))
}
}
print(df)
res <- ifelse(colSums(df <= 0.05) >= 4,TRUE, FALSE)
print(res)
print(names(res[res<0.05]))
}
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
mat_dim <- length(colnames(dcasted))
df <- data.frame(matrix(NA, nrow = mat_dim, ncol = mat_dim))
colnames(df) <- colnames(dcasted)
rownames(df) <- colnames(dcasted)
for(x in 1:mat_dim){
for(y in 1:mat_dim){
df[x,y] <- wilcox.test(as.numeric(dcasted[,x]),as.numeric(dcasted[,y]), exact = F)$p.value
}
}
ntest <- ((nrow(df)*ncol(df))-nrow(df))/2
df <- df*ntest
print(df)
res <- ifelse(colSums(df <= 0.05) >= 4,TRUE, FALSE)
print(res)
print(names(res[res<0.05]))
}
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(dcasted)
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(local_neg$Counts)
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(local_neg)
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(local_neg$Count)
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(as.numeric(local_neg$Count))
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(median(as.numeric(local_neg$Count)))
}
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(median(as.numeric(local_neg$Count)))
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
require(BiocGenerics)
require(matrixStats)
probe.exclusion <- function(control_genes){
require(matrixStats)
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(median(as.numeric(local_neg$Count)))
print(colMedians(dcasted))
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
require(matrixStats)
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted <- as.matrix(dcasted)
dcasted$L1 <- NULL
print(median(as.numeric(local_neg$Count)))
print(colMedians(dcasted))
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
require(matrixStats)
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(median(as.numeric(local_neg$Count)))
print(colMedians(as.numeric(dcasted)))
}
probe.exclusion <- function(control_genes){
require(matrixStats)
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted <- as.matrix(dcasted)
dcasted$L1 <- NULL
print(median(as.numeric(local_neg$Count)))
print(colMedians(dcasted))
}
probe.exclusion <- function(control_genes){
require(matrixStats)
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(median(as.numeric(local_neg$Count)))
print(colMedians(as.numeric(dcasted)))
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
require(matrixStats)
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
dcasted <- as.data.frame(lapply(dcasted, as.numeric))
print(median(as.numeric(local_neg$Count)))
print(colMedians(as.numeric(dcasted)))
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
require(matrixStats)
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
dcasted <- as.data.frame(lapply(dcasted, as.numeric))
print(dcasted)
print(median(as.numeric(local_neg$Count)))
print(colMedians(as.numeric(dcasted)))
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
require(matrixStats)
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(dcasted)
print(median(as.numeric(local_neg$Count)))
print(colMedians(as.numeric(dcasted)))
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(dcasted)
print(median(as.numeric(local_neg$Count)))
print(sapply(dcasted,function(x) median(as.numeric(x))))
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
(7-9)^2
4/8
(7-2)^2
25/8
(7-11)^2
16/8
0^2
0/8
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(dcasted)
overal_median <- median(as.numeric(local_neg$Count))
medians <- sapply(dcasted,function(x) median(as.numeric(x)))
print(overal_median)
print(medians)
}
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(dcasted)
overal_median <- median(as.numeric(local_neg$Count))
medians <- sapply(dcasted,function(x) median(as.numeric(x)))
print(overal_median)
print(medians)
sapply(medians,function(x) (overal_median-x)^2 / 7)
}
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(dcasted)
overal_median <- median(as.numeric(local_neg$Count))
medians <- sapply(dcasted,function(x) median(as.numeric(x)))
print(overal_median)
print(medians)
d <- sapply(medians,function(x) (overal_median-x)^2 / 7)
print(d)
}
test <- summarize("C:/Users/gbouland/Desktop/Data_test",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(dcasted)
overal_median <- median(as.numeric(local_neg$Count))
medians <- sapply(dcasted,function(x) median(as.numeric(x)))
print(overal_median)
print(medians)
d <- sapply(medians,function(x) (overal_median-x)^2 / (length(medians)-1))
print(d)
}
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(dcasted)
overal_median <- median(as.numeric(local_neg$Count))
medians <- sapply(dcasted,function(x) median(as.numeric(x)))
print(overal_median)
print(medians)
d <- sapply(medians,function(x) (overal_median-x)^2 / (length(medians)-1))
d <- sapply(medians,function(x) square((overal_median-x)^2))
print(d)
}
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
?sqrt
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(dcasted)
overal_median <- median(as.numeric(local_neg$Count))
medians <- sapply(dcasted,function(x) median(as.numeric(x)))
print(overal_median)
print(medians)
d <- sapply(medians,function(x) (overal_median-x)^2 / (length(medians)-1))
d <- sapply(medians,function(x) sqrt((overal_median-x)^2))
print(d)
}
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(dcasted)
overal_median <- median(as.numeric(local_neg$Count))
medians <- sapply(dcasted,function(x) median(as.numeric(x)))
print(overal_median)
print(medians)
d <- sapply(medians,function(x) (overal_median-x)^2 / (length(medians)-1))
print(d)
}
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(dcasted)
overal_median <- median(as.numeric(local_neg$Count))
medians <- sapply(dcasted,function(x) median(as.numeric(x)))
print(overal_median)
print(medians)
d <- sapply(medians,function(x) (overal_median-x)^2 / (length(medians)-1))
d <- sapply(medians,function(x) (overal_median-x)^2 / 516)
print(d)
}
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(dcasted)
overal_median <- median(as.numeric(local_neg$Count))
medians <- sapply(dcasted,function(x) median(as.numeric(x)))
print(overal_median)
print(medians)
d <- sapply(medians,function(x) (overal_median-x)^2 / (length(medians)-1))
print(d)
}
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
probe.exclusion <- function(control_genes){
local_neg <- control_genes[control_genes$CodeClass == "Negative",]
dcasted<- dcast(L1~Name, data = local_neg[,c("Name","L1","Count")])
rownames(dcasted) <- dcasted$L1
dcasted$L1 <- NULL
print(dcasted)
overal_median <- median(as.numeric(local_neg$Count))
medians <- sapply(dcasted,function(x) median(as.numeric(x)))
print(overal_median)
print(medians)
d <- sapply(medians,function(x) (overal_median-x)^2 / (length(medians)-1))
d <- sapply(medians,function(x) (overal_median-x)^2)
print(d)
}
test <- summarize("Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA",
"Z:/Roderick/Projects/Rhapsody/004 Omics/003 QC_Nanostring_miRNA/Samplesheet.csv",
"Accession","predict","GLM")
8*1.5
8*(1/1.5)
